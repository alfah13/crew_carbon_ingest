<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crew Carbon Data Pipeline - Slides</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e27;
            color: #fff;
            overflow: hidden;
        }

        .slides-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            padding: 60px;
            overflow-y: auto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .slide.active {
            display: flex !important;
            flex-direction: column;
            justify-content: center;
        }

        h1 {
            font-size: 4em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        h2 {
            font-size: 3em;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        h3 {
            font-size: 2em;
            margin-bottom: 30px;
        }

        .subtitle {
            font-size: 1.8em;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        .content {
            font-size: 1.3em;
            line-height: 1.8;
            max-width: 90%;
        }

        .content li {
            margin-bottom: 15px;
            margin-left: 40px;
        }

        .content p {
            margin-bottom: 15px;
        }

        .content code {
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }

        .content pre {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-size: 0.9em;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .box {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #66d9ef;
        }

        .stat-box {
            display: inline-block;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            margin: 10px;
            border-radius: 8px;
            border-left: 4px solid #66d9ef;
            min-width: 150px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #66d9ef;
        }

        .stat-label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 5px;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px 30px;
            border-radius: 50px;
        }

        button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 12px 25px;
            cursor: pointer;
            border-radius: 25px;
            font-size: 1em;
            transition: all 0.3s;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.6);
        }

        button:active {
            transform: scale(0.95);
        }

        .slide-counter {
            position: fixed;
            top: 20px;
            right: 30px;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1.1em;
            z-index: 100;
        }

        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 4px;
            background: rgba(102, 217, 239, 0.8);
            transition: width 0.2s linear;
            z-index: 50;
        }

        .title-slide {
            display: flex !important;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title-slide h1 {
            font-size: 5em;
        }

        .title-slide .subtitle {
            font-size: 2em;
            margin-top: 20px;
        }

        .title-slide .author {
            font-size: 1.3em;
            margin-top: 100px;
            color: rgba(255, 255, 255, 0.7);
        }

        @media (max-width: 1024px) {
            .slide {
                padding: 40px;
            }
            h1 { font-size: 2.5em; }
            h2 { font-size: 2em; }
            .content { font-size: 1.1em; }
            .two-column { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="slides-container">
        <!-- Slide 1: Title -->
        <div class="slide active title-slide">
            <h1>üå± Crew Carbon</h1>
            <div class="subtitle">Data Pipeline Presentation</div>
            <div style="font-size: 1.5em; color: rgba(255, 255, 255, 0.8);">CO‚ÇÇ Removal Calculation & Data Management</div>
            <div class="author">By Abdel Alfahham | 2025</div>
        </div>

        <!-- Slide 2: What Are We Building -->
        <div class="slide">
            <h2>What Are We Building?</h2>
            <div class="content">
                <ul>
                    <li>üìä Ingests lab and operational data from wastewater treatment plants</li>
                    <li>üß™ Validates and transforms raw data</li>
                    <li>üßÆ Calculates CO‚ÇÇ removal using scientific formulas</li>
                    <li>üìà Visualizes results for stakeholders</li>
                </ul>
            </div>
        </div>

        <!-- Slide 3: Three-Layer Architecture -->
        <div class="slide">
            <h2>Three-Layer Architecture</h2>
            <div class="content">
                <div class="box" style="margin: 20px 0;">
                    <h3 style="font-size: 1.5em; margin: 0;">Layer 1: Data Ingestion</h3>
                    Raw CSV/Excel files from plants ‚Üí Upload to S3
                </div>
                <div class="box" style="margin: 20px 0;">
                    <h3 style="font-size: 1.5em; margin: 0;">Layer 2: Transformation</h3>
                    Clean & standardize ‚Üí PostgreSQL normalized tables
                </div>
                <div class="box" style="margin: 20px 0;">
                    <h3 style="font-size: 1.5em; margin: 0;">Layer 3: Analysis & MRV</h3>
                    CO‚ÇÇ calculations ‚Üí Streamlit dashboard ‚Üí Expert review
                </div>
            </div>
        </div>

        <!-- Slide 4: Services -->
        <div class="slide">
            <h2>Services We Run</h2>
            <div class="content">
                <div class="two-column">
                    <div class="box">
                        <strong>üêç Python App</strong><br/>
                        Backend processing<br/>
                        <code>localhost:8500</code>
                    </div>
                    <div class="box">
                        <strong>üêò PostgreSQL</strong><br/>
                        Normalized data<br/>
                        <code>crewcarbon:localdev@postgres</code>
                    </div>
                    <div class="box">
                        <strong>üìä Streamlit</strong><br/>
                        Interactive dashboard<br/>
                        <code>http://0.0.0.0:8501</code>
                    </div>
                    <div class="box">
                        <strong>üìì Jupyter</strong><br/>
                        Data exploration<br/>
                        <code>http://localhost:8888</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Quick Start -->
        <div class="slide">
            <h2>Getting Started (30 seconds)</h2>
            <div class="content">
                <pre><code># 1. Build containers
docker-compose build

# 2. Start services
docker-compose up -d

# 3. Initialize & run pipelines
make run-all-pipelines

# 4. Open dashboard
# Streamlit: http://0.0.0.0:8501/
# Jupyter: http://localhost:8888/</code></pre>
            </div>
        </div>

        <!-- Slide 6: Data Pipelines Pattern -->
        <div class="slide">
            <h2>Data Transformation Pipelines</h2>
            <div class="content">
                <p style="font-size: 1.5em; text-align: center; margin: 40px 0;">
                    <strong>All follow the same pattern:</strong>
                </p>
                <pre><code>Load ‚Üí Transform ‚Üí Compress Metadata ‚Üí Insert to DB</code></pre>
                <p style="margin-top: 30px;">Three main pipelines:</p>
                <ul>
                    <li>Calcium (Ca) - Lab data CSV files</li>
                    <li>pH - Sensor data (minute-by-minute)</li>
                    <li>Operations - Plant A & Plant B Excel files</li>
                </ul>
            </div>
        </div>

        <!-- Slide 7: CO2 Calculation -->
        <div class="slide">
            <h2>CO‚ÇÇ Removal Calculation</h2>
            <div class="content">
                <p><strong>Step 1: Calcium Delta</strong></p>
                <pre><code>ca_delta = ca_downstream - ca_upstream  # mg/L</code></pre>
                <p><strong>Step 2-3: Flow Rate & CaCO‚ÇÉ</strong></p>
                <pre><code>flow_l_day = flow_mgd * 3785.41 * 1000
ca_to_caco3 = 100.0869 / 40.078
caco3_mg = ca_delta * flow_l_day * ca_to_caco3</code></pre>
            </div>
        </div>

        <!-- Slide 8: CO2 Calculation Continued -->
        <div class="slide">
            <h2>CO‚ÇÇ Removal Calculation (continued)</h2>
            <div class="content">
                <p><strong>Step 4-5: CO‚ÇÇ Mass & Final Conversion</strong></p>
                <pre><code>co2_to_caco3 = 44.0095 / 100.0869
co2_mg = caco3_mg * co2_to_caco3
co2_mt_day = co2_mg / 1_000_000_000  # Final result</code></pre>
                <p style="margin-top: 30px;"><strong>Molecular Weights:</strong></p>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px;">
                    <div class="stat-box">
                        <div class="stat-value">40.078</div>
                        <div class="stat-label">MW_Ca (g/mol)</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">100.09</div>
                        <div class="stat-label">MW_CaCO‚ÇÉ (g/mol)</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">44.01</div>
                        <div class="stat-label">MW_CO‚ÇÇ (g/mol)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 9: QA/QC -->
        <div class="slide">
            <h2>QA/QC: 5-Level Pyramid</h2>
            <div class="content">
                <div class="box" style="margin: 10px 0; padding: 15px;">
                    <strong>Level 1:</strong> Raw Data Ingestion - File format, encoding, parsing, duplicates
                </div>
                <div class="box" style="margin: 10px 0; padding: 15px;">
                    <strong>Level 2:</strong> Data Completeness - Non-null columns, missing values, date records
                </div>
                <div class="box" style="margin: 10px 0; padding: 15px;">
                    <strong>Level 3:</strong> Schema & Type Validation - Data types, required fields, FK integrity
                </div>
                <div class="box" style="margin: 10px 0; padding: 15px;">
                    <strong>Level 4:</strong> Data Quality Flags - Ca delta validation, flow checks
                </div>
                <div class="box" style="margin: 10px 0; padding: 15px;">
                    <strong>Level 5:</strong> Business Logic - MRV calculations, domain rules, expert review
                </div>
            </div>
        </div>

        <!-- Slide 10: MRV Validation -->
        <div class="slide">
            <h2>MRV Validation Checks</h2>
            <div class="content">
                <p><strong>‚úì Check 1: Operational Data</strong><br/>
                   Flow rates > 0 ‚Üí Fails = Calculation skipped</p>
                <p style="margin-top: 20px;"><strong>‚úì Check 2: Calcium Readings</strong><br/>
                   Both upstream & downstream exist ‚Üí Fails = Calculation skipped</p>
                <p style="margin-top: 20px;"><strong>‚úì Check 3: Calcium Delta</strong><br/>
                   Delta > 0 (removal detected) ‚Üí Proceeds but may be flagged "INVALID"</p>
                <p style="margin-top: 30px; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px;">
                    <strong>Outcome:</strong> Critical failures stop calculation. Non-critical issues proceed but are flagged for review.
                </p>
            </div>
        </div>

        <!-- Slide 11: Database Schema -->
        <div class="slide">
            <h2>Core Database Tables</h2>
            <div class="content">
                <div class="two-column">
                    <div class="box">
                        <strong>crew_carbon_lab_reading</strong>
                        <ul style="margin-top: 10px; font-size: 0.9em;">
                            <li>id (PK)</li>
                            <li>plant_id (FK)</li>
                            <li>reading_date</li>
                            <li>parameter (Ca, pH)</li>
                            <li>value, unit</li>
                            <li>metadata (JSON)</li>
                        </ul>
                    </div>
                    <div class="box">
                        <strong>waste_water_plant_operation</strong>
                        <ul style="margin-top: 10px; font-size: 0.9em;">
                            <li>id (PK)</li>
                            <li>plant_id (FK)</li>
                            <li>operation_date</li>
                            <li>actual_eff_flow_mgd</li>
                            <li>influent_flow_mgd</li>
                            <li>bypass_flag</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 12: Development -->
        <div class="slide">
            <h2>Development Workflow</h2>
            <div class="content">
                <p><strong>Local Development:</strong></p>
                <pre><code>make up              # Start services
make shell           # Bash in container
python src/ingest/ca_pipeline.py  # Run pipeline
pytest tests/...     # Run tests</code></pre>
                <p style="margin-top: 20px;"><strong>View & Test:</strong></p>
                <ul>
                    <li>PostgreSQL CLI: <code>make db-shell</code></li>
                    <li>Jupyter: <code>http://localhost:8888</code></li>
                    <li>Dashboard: <code>http://0.0.0.0:8501</code></li>
                </ul>
            </div>
        </div>

        <!-- Slide 13: Commands -->
        <div class="slide">
            <h2>Essential Commands</h2>
            <div class="content">
                <pre><code>make up                  # Start all containers
make down                # Stop containers
make shell               # Bash shell in app
make db-shell            # PostgreSQL CLI
make test                # Run pytest suite
make clean               # Remove all data
make run-all-pipelines   # Full pipeline run</code></pre>
            </div>
        </div>

        <!-- Slide 14: Scale -->
        <div class="slide">
            <h2>Scale & Performance</h2>
            <div class="content">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div class="stat-box">
                        <div class="stat-value">50-200</div>
                        <div class="stat-label">Receiver Stations</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">150-600</div>
                        <div class="stat-label">EM Responses</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">1,950-7,800</div>
                        <div class="stat-label">Off-Time Channels</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">2,100-8,600+</div>
                        <div class="stat-label">Total Rows/Survey</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 15: Team Roles -->
        <div class="slide">
            <h2>Who Does What?</h2>
            <div class="content">
                <div class="box" style="margin: 15px 0;">
                    <strong>üë®‚Äçüíª Data Engineers:</strong> Full dev access, write/test pipelines
                </div>
                <div class="box" style="margin: 15px 0;">
                    <strong>üî¨ Data Scientists:</strong> Read-only DB, Jupyter, dashboards
                </div>
                <div class="box" style="margin: 15px 0;">
                    <strong>üë®‚Äçüî¨ Domain Experts:</strong> Dashboard review, approve calculations
                </div>
                <div class="box" style="margin: 15px 0;">
                    <strong>üìä Stakeholders:</strong> View KPIs & trends, no technical access
                </div>
            </div>
        </div>

        <!-- Slide 16: Data Flow -->
        <div class="slide">
            <h2>End-to-End Data Flow</h2>
            <div class="content" style="font-size: 1.2em; line-height: 2;">
                <p>üìÅ Raw Data Files</p>
                <p>‚Üì Upload to S3</p>
                <p>üîÑ Parallel Pipelines (Ca, pH, Ops)</p>
                <p>‚Üì Normalize to DB Tables</p>
                <p>‚úÖ QA/QC Validation (5 levels)</p>
                <p>‚Üì Dashboard Visualization</p>
                <p>üëÅÔ∏è Expert Review</p>
                <p>‚Üì Final Approval</p>
                <p>üìà Production Results</p>
            </div>
        </div>

        <!-- Slide 17: Best Practices -->
        <div class="slide">
            <h2>Performance Best Practices</h2>
            <div class="content">
                <div class="box" style="margin: 20px 0;">
                    <strong>Database:</strong> Create indexes on plant_id, date
                </div>
                <div class="box" style="margin: 20px 0;">
                    <strong>Dashboard:</strong> Use Streamlit caching with @st.cache_data
                </div>
                <div class="box" style="margin: 20px 0;">
                    <strong>Data Ops:</strong> Batch inserts instead of one-by-one
                </div>
                <div class="box" style="margin: 20px 0;">
                    <strong>Monitoring:</strong> CloudWatch tracks query times
                </div>
            </div>
        </div>

        <!-- Slide 18: Next Steps -->
        <div class="slide">
            <h2>Next Steps</h2>
            <div class="content">
                <ul style="font-size: 1.4em;">
                    <li>‚úÖ Run <code>make run-all-pipelines</code> locally</li>
                    <li>‚úÖ Explore dashboard at <code>http://0.0.0.0:8501</code></li>
                    <li>‚úÖ Review test suite with <code>make test</code></li>
                    <li>‚úÖ Try Jupyter at <code>http://localhost:8888</code></li>
                    <li>‚úÖ Join code review process</li>
                </ul>
            </div>
        </div>

        <!-- Slide 19: Questions -->
        <div class="slide title-slide">
            <h2 style="font-size: 4em; margin-bottom: 50px;">Questions?</h2>
            <div style="font-size: 1.8em;">
                <p><strong>Crew Carbon Team</strong></p>
                <p style="margin-top: 20px; color: rgba(255, 255, 255, 0.8);">Abdel Alfahham</p>
                <p style="margin-top: 50px; font-size: 1.3em; color: rgba(255, 255, 255, 0.7);">2025 Data Pipeline Presentation</p>
            </div>
        </div>
    </div>

    <div class="progress-bar" id="progressBar"></div>
    <div class="slide-counter" id="slideCounter">1 / 19</div>

    <div class="controls">
        <button onclick="prevSlide()">‚Üê Previous</button>
        <button onclick="nextSlide()">Next ‚Üí</button>
        <button onclick="toggleAutoplay()">‚èØÔ∏è <span id="autoplayText">Pause</span></button>
    </div>

    <script>
        let currentSlide = 0;
        let autoplayInterval = null;
        let isAutoplay = true;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        const AUTOPLAY_INTERVAL = 8000; // 8 seconds per slide

        function showSlide(n) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[n].classList.add('active');
            updateCounter();
            updateProgress();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            showSlide(currentSlide);
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            showSlide(currentSlide);
        }

        function updateCounter() {
            document.getElementById('slideCounter').textContent = `${currentSlide + 1} / ${totalSlides}`;
        }

        function updateProgress() {
            const progress = ((currentSlide + 1) / totalSlides) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function toggleAutoplay() {
            if (isAutoplay) {
                clearInterval(autoplayInterval);
                autoplayInterval = null;
                isAutoplay = false;
                document.getElementById('autoplayText').textContent = 'Play';
            } else {
                autoplayInterval = setInterval(nextSlide, AUTOPLAY_INTERVAL);
                isAutoplay = true;
                document.getElementById('autoplayText').textContent = 'Pause';
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') { 
                e.preventDefault();
                nextSlide(); 
            }
            if (e.key === 'ArrowLeft') { 
                e.preventDefault();
                prevSlide(); 
            }
        });

        // Initialize
        showSlide(0);

        // Start autoplay
        autoplayInterval = setInterval(nextSlide, AUTOPLAY_INTERVAL);
    </script>
</body>
</html>